dev
 subcmd
   build
     Builds the tasty-sugar library
       exec = cabal build tasty-sugar
   test
     testcase
       test-sugar
         type = EXE
         runner = cabal_test
       test-passthru-ascii
         type = EXE
         runner = cabal_test
       test-params
         type = EXE
         runner = cabal_test
       test-internals
         type = EXE
         runner = cabal_test
     testrunner
       cabal_test
         exec = cabal test {TestName}
   nixbuild:old
     Uses nix to build with old GHC versions
       in dir = {TopDir}
       exec =
         nix build --no-link  --override-input nixpkgs github:nixos/nixpkgs/25.05 $(for X in 810 90 92; do echo .#tasty-sugar.ghc$X; done)
         nix build --no-link .#tasty-sugar.ghc94
   nixbuild:recent
     Uses nix to build with recent GHC versions
       in dir = {TopDir}
       exec = nix build --no-link .#tasty-sugar.ghc96 .#tasty-sugar.ghc98
   nixbuild
     Uses nix to build with current GHC versions
       in dir = {TopDir}
       exec = nix build --no-link .#tasty-sugar.ghc910 .#tasty-sugar.ghc912
   nixbuild:all =
     Uses nix to build with all supported GHC versions =
       in dir = {TopDir}
       needs = nixbuild nixbuild:old nixbuild:recent
       exec = echo All nix builds completed

   ci-build =
     Build target for CI
       in dir = {TopDir}
       notes =

         This uses "nix run" instead of "nix build" for Github CI support.  This
         is less efficient in that there is no parallelism, but more efficient
         because a nix build will fetch all dependencies (from
         github:nixos/nixpkgs or cachix) even if there is no actual build needed
         and a nix run will only fetch the runtime closure but *will* perform a
         nix build if needed.

       env vars =
         CI_TEST_LEVEL = 1
       exec =
         echo :::: GHC 8.10
         nix run --override-input nixpkgs github:nixos/nixpkgs/25.05 .#tasty-sugar.ghc810
         echo :::: GHC 9.0
         nix run --override-input nixpkgs github:nixos/nixpkgs/25.05 .#tasty-sugar.ghc90
         echo :::: GHC 9.2
         nix run --override-input nixpkgs github:nixos/nixpkgs/25.05 .#tasty-sugar.ghc92
         for V in 9.4 9.6 9.8 9.10 9.12 ; do
           echo :::: GHC $V
           nix run .#tasty-sugar.ghc$(echo $V | sed -e s/\\.//)
         done
